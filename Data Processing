import warnings
warnings.filterwarnings('ignore')
# Reading the dataset
import pandas as pd
import numpy as np
ZomatoData=pd.read_csv('/Users/farukh/Python Case Studies/ZomatoData.csv', encoding='latin')
print('Shape before deleting duplicate values:', ZomatoData.shape)

# Removing duplicate rows if any
ZomatoData=ZomatoData.drop_duplicates()
print('Shape After deleting duplicate values:', ZomatoData.shape)

# Printing sample data
# Start observing the Quantitative/Categorical/Qualitative variables
ZomatoData.head(10)
Shape before deleting duplicate values: (9551, 19)
Shape After deleting duplicate values: (9551, 19)
Restaurant ID	Restaurant Name	Country Code	City	Address	Locality	Locality Verbose	Longitude	Latitude	Cuisines	Currency	Has Table booking	Has Online delivery	Is delivering now	Switch to order menu	Price range	Votes	Average Cost for two	Rating
0	6317637	Le Petit Souffle	162	Makati City	Third Floor, Century City Mall, Kalayaan Avenu...	Century City Mall, Poblacion, Makati City	Century City Mall, Poblacion, Makati City, Mak...	121.027535	14.565443	French, Japanese, Desserts	Botswana Pula(P)	Yes	No	No	No	3	314	1100	4.8
1	6304287	Izakaya Kikufuji	162	Makati City	Little Tokyo, 2277 Chino Roces Avenue, Legaspi...	Little Tokyo, Legaspi Village, Makati City	Little Tokyo, Legaspi Village, Makati City, Ma...	121.014101	14.553708	Japanese	Botswana Pula(P)	Yes	No	No	No	3	591	1200	4.5
2	6300002	Heat - Edsa Shangri-La	162	Mandaluyong City	Edsa Shangri-La, 1 Garden Way, Ortigas, Mandal...	Edsa Shangri-La, Ortigas, Mandaluyong City	Edsa Shangri-La, Ortigas, Mandaluyong City, Ma...	121.056831	14.581404	Seafood, Asian, Filipino, Indian	Botswana Pula(P)	Yes	No	No	No	4	270	4000	4.4
3	6318506	Ooma	162	Mandaluyong City	Third Floor, Mega Fashion Hall, SM Megamall, O...	SM Megamall, Ortigas, Mandaluyong City	SM Megamall, Ortigas, Mandaluyong City, Mandal...	121.056475	14.585318	Japanese, Sushi	Botswana Pula(P)	No	No	No	No	4	365	1500	4.9
4	6314302	Sambo Kojin	162	Mandaluyong City	Third Floor, Mega Atrium, SM Megamall, Ortigas...	SM Megamall, Ortigas, Mandaluyong City	SM Megamall, Ortigas, Mandaluyong City, Mandal...	121.057508	14.584450	Japanese, Korean	Botswana Pula(P)	Yes	No	No	No	4	229	1500	4.8
5	18189371	Din Tai Fung	162	Mandaluyong City	Ground Floor, Mega Fashion Hall, SM Megamall, ...	SM Megamall, Ortigas, Mandaluyong City	SM Megamall, Ortigas, Mandaluyong City, Mandal...	121.056314	14.583764	Chinese	Botswana Pula(P)	No	No	No	No	3	336	1000	4.4
6	6300781	Buffet 101	162	Pasay City	Building K, SM By The Bay, Sunset Boulevard, M...	SM by the Bay, Mall of Asia Complex, Pasay City	SM by the Bay, Mall of Asia Complex, Pasay Cit...	120.979667	14.531333	Asian, European	Botswana Pula(P)	Yes	No	No	No	4	520	2000	4.0
7	6301290	Vikings	162	Pasay City	Building B, By The Bay, Seaside Boulevard, Mal...	SM by the Bay, Mall of Asia Complex, Pasay City	SM by the Bay, Mall of Asia Complex, Pasay Cit...	120.979333	14.540000	Seafood, Filipino, Asian, European	Botswana Pula(P)	Yes	No	No	No	4	677	2000	4.2
8	6300010	Spiral - Sofitel Philippine Plaza Manila	162	Pasay City	Plaza Level, Sofitel Philippine Plaza Manila, ...	Sofitel Philippine Plaza Manila, Pasay City	Sofitel Philippine Plaza Manila, Pasay City, P...	120.980090	14.552990	European, Asian, Indian	Botswana Pula(P)	Yes	No	No	No	4	621	6000	4.9
9	6314987	Locavore	162	Pasig City	Brixton Technology Center, 10 Brixton Street, ...	Kapitolyo	Kapitolyo, Pasig City	121.056532	14.572041	Filipino	Botswana Pula(P)	Yes	No	No	No	3	532	1100	4.8
Defining the problem statement:
Create a Predictive model which can predict the future Rating of a restaurant
Target Variable: Rating
Predictors: location, menu, cost etc.
Rating=1 Worst
Rating=5 Best
Determining the type of Machine Learning
Based on the problem statement you can understand that we need to create a supervised ML Regression model, as the target variable is Continuous.

Looking at the distribution of Target variable
If target variable's distribution is too skewed then the predictive modeling will not be possible.
Bell curve is desirable but slightly positive skew or negative skew is also fine
When performing Regression, make sure the histogram looks like a bell curve or slight skewed version of it. Otherwise it impacts the Machine Learning algorithms ability to learn all the scenarios.
%matplotlib inline
# Creating Bar chart as the Target variable is Continuous
ZomatoData['Rating'].hist()
<matplotlib.axes._subplots.AxesSubplot at 0x11d0416d0>

The data distribution of the target variable is satisfactory to proceed further. There are sufficient number of rows for each type of values to learn from.

Basic Data Exploration
This step is performed to guage the overall data. The volume of data, the types of columns present in the data. Initial assessment of the data should be done to identify which columns are Quantitative, Categorical or Qualitative.

This step helps to start the column rejection process. You must look at each column carefully and ask, does this column affect the values of the Target variable? For example in this case study, you will ask, does this column affect the rating of the Restaurant? If the answer is a clear "No", then remove the column immediately from the data, otherwise keep the column for further analysis.

There are four commands which are used for Basic data exploration in Python

head() : This helps to see a few sample rows of the data
info() : This provides the summarized information of the data
describe() : This provides the descriptive statistical details of the data
nunique(): This helps us to identify if a column is categorical or continuous
# Looking at sample rows in the data
ZomatoData.head()
Restaurant ID	Restaurant Name	Country Code	City	Address	Locality	Locality Verbose	Longitude	Latitude	Cuisines	Currency	Has Table booking	Has Online delivery	Is delivering now	Switch to order menu	Price range	Votes	Average Cost for two	Rating
0	6317637	Le Petit Souffle	162	Makati City	Third Floor, Century City Mall, Kalayaan Avenu...	Century City Mall, Poblacion, Makati City	Century City Mall, Poblacion, Makati City, Mak...	121.027535	14.565443	French, Japanese, Desserts	Botswana Pula(P)	Yes	No	No	No	3	314	1100	4.8
1	6304287	Izakaya Kikufuji	162	Makati City	Little Tokyo, 2277 Chino Roces Avenue, Legaspi...	Little Tokyo, Legaspi Village, Makati City	Little Tokyo, Legaspi Village, Makati City, Ma...	121.014101	14.553708	Japanese	Botswana Pula(P)	Yes	No	No	No	3	591	1200	4.5
2	6300002	Heat - Edsa Shangri-La	162	Mandaluyong City	Edsa Shangri-La, 1 Garden Way, Ortigas, Mandal...	Edsa Shangri-La, Ortigas, Mandaluyong City	Edsa Shangri-La, Ortigas, Mandaluyong City, Ma...	121.056831	14.581404	Seafood, Asian, Filipino, Indian	Botswana Pula(P)	Yes	No	No	No	4	270	4000	4.4
3	6318506	Ooma	162	Mandaluyong City	Third Floor, Mega Fashion Hall, SM Megamall, O...	SM Megamall, Ortigas, Mandaluyong City	SM Megamall, Ortigas, Mandaluyong City, Mandal...	121.056475	14.585318	Japanese, Sushi	Botswana Pula(P)	No	No	No	No	4	365	1500	4.9
4	6314302	Sambo Kojin	162	Mandaluyong City	Third Floor, Mega Atrium, SM Megamall, Ortigas...	SM Megamall, Ortigas, Mandaluyong City	SM Megamall, Ortigas, Mandaluyong City, Mandal...	121.057508	14.584450	Japanese, Korean	Botswana Pula(P)	Yes	No	No	No	4	229	1500	4.8
# Observing the summarized information of data
# Data types, Missing values based on number of non-null values Vs total rows etc.
# Remove those variables from data which have too many missing values (Missing Values > 30%)
# Remove Qualitative variables which cannot be used in Machine Learning
ZomatoData.info()
<class 'pandas.core.frame.DataFrame'>
Int64Index: 9551 entries, 0 to 9550
Data columns (total 19 columns):
Restaurant ID           9551 non-null int64
Restaurant Name         9551 non-null object
Country Code            9551 non-null int64
City                    9551 non-null object
Address                 9551 non-null object
Locality                9551 non-null object
Locality Verbose        9551 non-null object
Longitude               9551 non-null float64
Latitude                9551 non-null float64
Cuisines                9542 non-null object
Currency                9551 non-null object
Has Table booking       9551 non-null object
Has Online delivery     9551 non-null object
Is delivering now       9551 non-null object
Switch to order menu    9551 non-null object
Price range             9551 non-null int64
Votes                   9551 non-null int64
Average Cost for two    9551 non-null int64
Rating                  9551 non-null float64
dtypes: float64(3), int64(5), object(11)
memory usage: 1.5+ MB
# Looking at the descriptive statistics of the data
ZomatoData.describe(include='all')
Restaurant ID	Restaurant Name	Country Code	City	Address	Locality	Locality Verbose	Longitude	Latitude	Cuisines	Currency	Has Table booking	Has Online delivery	Is delivering now	Switch to order menu	Price range	Votes	Average Cost for two	Rating
count	9.551000e+03	9551	9551.000000	9551	9551	9551	9551	9551.000000	9551.000000	9542	9551	9551	9551	9551	9551	9551.000000	9551.000000	9551.000000	9551.000000
unique	NaN	7446	NaN	141	8918	1208	1265	NaN	NaN	1825	12	2	2	2	1	NaN	NaN	NaN	NaN
top	NaN	Cafe Coffee Day	NaN	New Delhi	Sector 41, Noida	Connaught Place	Connaught Place, New Delhi	NaN	NaN	North Indian	Indian Rupees(Rs.)	No	No	No	No	NaN	NaN	NaN	NaN
freq	NaN	83	NaN	5473	11	122	122	NaN	NaN	936	8652	8393	7100	9517	9551	NaN	NaN	NaN	NaN
mean	9.051128e+06	NaN	18.365616	NaN	NaN	NaN	NaN	64.126574	25.854381	NaN	NaN	NaN	NaN	NaN	NaN	1.804837	156.909748	1199.210763	2.891268
std	8.791521e+06	NaN	56.750546	NaN	NaN	NaN	NaN	41.467058	11.007935	NaN	NaN	NaN	NaN	NaN	NaN	0.905609	430.169145	16121.183073	1.128845
min	5.300000e+01	NaN	1.000000	NaN	NaN	NaN	NaN	-157.948486	-41.330428	NaN	NaN	NaN	NaN	NaN	NaN	1.000000	0.000000	0.000000	1.000000
25%	3.019625e+05	NaN	1.000000	NaN	NaN	NaN	NaN	77.081343	28.478713	NaN	NaN	NaN	NaN	NaN	NaN	1.000000	5.000000	250.000000	2.500000
50%	6.004089e+06	NaN	1.000000	NaN	NaN	NaN	NaN	77.191964	28.570469	NaN	NaN	NaN	NaN	NaN	NaN	2.000000	31.000000	400.000000	3.200000
75%	1.835229e+07	NaN	1.000000	NaN	NaN	NaN	NaN	77.282006	28.642758	NaN	NaN	NaN	NaN	NaN	NaN	2.000000	131.000000	700.000000	3.700000
max	1.850065e+07	NaN	216.000000	NaN	NaN	NaN	NaN	174.832089	55.976980	NaN	NaN	NaN	NaN	NaN	NaN	4.000000	10934.000000	800000.000000	4.900000
# Finging unique values for each column
# TO understand which column is categorical and which one is Continuous
# Typically if the numer of unique values are < 20 then the variable is likely to be a category otherwise continuous
ZomatoData.nunique()
Restaurant ID           9551
Restaurant Name         7446
Country Code              15
City                     141
Address                 8918
Locality                1208
Locality Verbose        1265
Longitude               8120
Latitude                8677
Cuisines                1825
Currency                  12
Has Table booking          2
Has Online delivery        2
Is delivering now          2
Switch to order menu       1
Price range                4
Votes                   1012
Average Cost for two     140
Rating                    33
dtype: int64
Basic Data Exploration Results
Based on the basic exploration above, you can now create a simple report of the data, noting down your observations regaring each column. Hence, creating a initial roadmap for further analysis.

The selected columns in this step are not final, further study will be done and then a final list will be created

Restaurant ID: Qualitative. Rejected.
Restaurant Name: Qualitative. Rejected.
Country Code: Categorical. Selected.
City: Categorical. Rejected. Too many unique levels, hence it will cause high dimensionality
Address: Qualitative. Rejected.
Locality: Qualitative. Rejected.
Locality Verbose: Qualitative. Rejected.
Longitude: Continuous. Selected. This represents the location of restaurant
Latitude: Continuous. Selected. This represents the location of restaurant
Cuisines: Qualitative. Rejected. A new feature can be engineered from it.
Currency: Categorical. Selected.
Has Table booking: Categorical. Selected.
Has Online delivery: Categorical. Selected.
Is delivering now: Categorical. Selected.
Switch to order menu: Categorical. Selected.
Price range: Categorical. Selected.
Votes: Continuous. Selected.
Average Cost for two: Continuous. Selected.
Rating: Continuous. Selected. This is the Target Variable!
Feature Engineering
Some of the columns cannot be used directly for machine learning like Dates, addresses, etc. because these are qualitative in nature. Hence every row has a different string value, Hence the ML algorithms cannot learn anything from them because each row has a different description. In simple terms, no general rules can be created from such columns.

However, we can extract some information from these columns, which can be used in ML. Like from a date column we can take out month, week, quarter etc, which becomes categorical feature.

Similarly we can extract some repetitive information from address like zip codes, locality etc. however if the number of unique values is too high in them (more than 50) then it creates trouble later for the ML algorithm as the data dimensionality increases while converting such columns to dummy variables.

In this data the "Cuisines" column cannot be used directly because it will generate 1825 dummy variables!! Hence, we can count the number of cuisines offered, which can be a number, hence it can be used in ML.

# Function to count the number of cuisines
def cuisine_counter(inpStr):
    NumCuisines=len(str(inpStr).split(','))
    return(NumCuisines)
# Creating a new feature in data
# We will further explore the new feature just like other features
ZomatoData['CuisineCount']=ZomatoData['Cuisines'].apply(cuisine_counter)
ZomatoData.head()
Restaurant ID	Restaurant Name	Country Code	City	Address	Locality	Locality Verbose	Longitude	Latitude	Cuisines	Currency	Has Table booking	Has Online delivery	Is delivering now	Switch to order menu	Price range	Votes	Average Cost for two	Rating	CuisineCount
0	6317637	Le Petit Souffle	162	Makati City	Third Floor, Century City Mall, Kalayaan Avenu...	Century City Mall, Poblacion, Makati City	Century City Mall, Poblacion, Makati City, Mak...	121.027535	14.565443	French, Japanese, Desserts	Botswana Pula(P)	Yes	No	No	No	3	314	1100	4.8	3
1	6304287	Izakaya Kikufuji	162	Makati City	Little Tokyo, 2277 Chino Roces Avenue, Legaspi...	Little Tokyo, Legaspi Village, Makati City	Little Tokyo, Legaspi Village, Makati City, Ma...	121.014101	14.553708	Japanese	Botswana Pula(P)	Yes	No	No	No	3	591	1200	4.5	1
2	6300002	Heat - Edsa Shangri-La	162	Mandaluyong City	Edsa Shangri-La, 1 Garden Way, Ortigas, Mandal...	Edsa Shangri-La, Ortigas, Mandaluyong City	Edsa Shangri-La, Ortigas, Mandaluyong City, Ma...	121.056831	14.581404	Seafood, Asian, Filipino, Indian	Botswana Pula(P)	Yes	No	No	No	4	270	4000	4.4	4
3	6318506	Ooma	162	Mandaluyong City	Third Floor, Mega Fashion Hall, SM Megamall, O...	SM Megamall, Ortigas, Mandaluyong City	SM Megamall, Ortigas, Mandaluyong City, Mandal...	121.056475	14.585318	Japanese, Sushi	Botswana Pula(P)	No	No	No	No	4	365	1500	4.9	2
4	6314302	Sambo Kojin	162	Mandaluyong City	Third Floor, Mega Atrium, SM Megamall, Ortigas...	SM Megamall, Ortigas, Mandaluyong City	SM Megamall, Ortigas, Mandaluyong City, Mandal...	121.057508	14.584450	Japanese, Korean	Botswana Pula(P)	Yes	No	No	No	4	229	1500	4.8	2
 
Removing useless columns from the data
# Deleting those columns which are not useful in predictive analysis because these variables are qualitative
UselessColumns = ['Restaurant ID', 'Restaurant Name','City','Address',
                  'Locality', 'Locality Verbose','Cuisines']
ZomatoData = ZomatoData.drop(UselessColumns,axis=1)
ZomatoData.head()
Country Code	Longitude	Latitude	Currency	Has Table booking	Has Online delivery	Is delivering now	Switch to order menu	Price range	Votes	Average Cost for two	Rating	CuisineCount
0	162	121.027535	14.565443	Botswana Pula(P)	Yes	No	No	No	3	314	1100	4.8	3
1	162	121.014101	14.553708	Botswana Pula(P)	Yes	No	No	No	3	591	1200	4.5	1
2	162	121.056831	14.581404	Botswana Pula(P)	Yes	No	No	No	4	270	4000	4.4	4
3	162	121.056475	14.585318	Botswana Pula(P)	No	No	No	No	4	365	1500	4.9	2
4	162	121.057508	14.584450	Botswana Pula(P)	Yes	No	No	No	4	229	1500	4.8	2
 
Visual Exploratory Data Analysis
Categorical variables: Bar plot
Continuous variables: Histogram
Visualize distribution of all the Categorical Predictor variables in the data using bar plots
We can spot a categorical variable in the data by looking at the unique values in them. Typically a categorical variable contains less than 20 Unique values AND there is repetition of values, which means the data can be grouped by those unique values.

Based on the Basic Data Exploration above, we have spotted seven categorical predictors in the data

Categorical Predictors: 'Country Code', 'Currency', 'Has Table booking', 'Has Online delivery', 'Is delivering now', 'Switch to order menu','Price range'

We use bar charts to see how the data is distributed for these categorical columns.

# Plotting multiple bar charts at once for categorical variables
# Since there is no default function which can plot bar charts for multiple columns at once
# we are defining our own function for the same

def PlotBarCharts(inpData, colsToPlot):
    %matplotlib inline
    
    import matplotlib.pyplot as plt
    
    # Generating multiple subplots
    fig, subPlot=plt.subplots(nrows=1, ncols=len(colsToPlot), figsize=(20,5))
    fig.suptitle('Bar charts of: '+ str(colsToPlot))

    for colName, plotNumber in zip(colsToPlot, range(len(colsToPlot))):
        inpData.groupby(colName).size().plot(kind='bar',ax=subPlot[plotNumber])
#####################################################################
# Calling the function
PlotBarCharts(inpData=ZomatoData, colsToPlot=[
    'Country Code', 'Currency', 'Has Table booking', 'Has Online delivery', 'Is delivering now',
    'Switch to order menu','Price range'])

Bar Charts Interpretation
These bar charts represent the frequencies of each category in the Y-axis and the category names in the X-axis.

In the ideal bar chart each category has comparable frequency. Hence, there are enough rows for each category in the data for the ML algorithm to learn.

If there is a column which shows too skewed distribution where there is only one dominant bar and the other categories are present in very low numbers. These kind of columns may not be very helpful in machine learning. We confirm this in the correlation analysis section and take a final call to select or reject the column.

In this data, "Country Code", "Currency", "is delivering now" and "Switch to order menu" are too skewed. There is just one bar which is dominating and other categories have very less rows or there is just one value only. Such columns are not correlated with the target variable because there is no information to learn. The algorithms cannot find any rule like when the value is this then the target variable is that.

Selected Categorical Variables: Only three categorical variables are selected for further analysis.

'Has Table booking', 'Has Online delivery', 'Price range'

 
Visualize distribution of all the Continuous Predictor variables in the data using histograms
Based on the Basic Data Exploration, There are four continuous predictor variables ''Longitude', 'Latitude','Votes', and 'Average Cost for two'

# Plotting histograms of multiple columns together
ZomatoData.hist(['Longitude', 'Latitude', 
                 'Votes', 'Average Cost for two'], figsize=(18,10))
array([[<matplotlib.axes._subplots.AxesSubplot object at 0x11dd44950>,
        <matplotlib.axes._subplots.AxesSubplot object at 0x11dff6910>],
       [<matplotlib.axes._subplots.AxesSubplot object at 0x11e277cd0>,
        <matplotlib.axes._subplots.AxesSubplot object at 0x11e2ad9d0>]],
      dtype=object)

Histogram Interpretation
Histograms shows us the data distribution for a single continuous variable.

The X-axis shows the range of values and Y-axis represent the number of values in that range. For example, in the above histogram of "Votes", there are around 9000 rows in data that has a vote value between 0 to 1000.

The ideal outcome for histogram is a bell curve or slightly skewed bell curve. If there is too much skewness, then outlier treatment should be done and the column should be re-examined, if that also does not solve the problem then only reject the column.

Selected Continuous Variables:

Longitude : Selected. The distribution is good.
Latitude: Selected. The distribution is good.
Votes: Selected. Outliers seen beyond 300000, need to treat them.
Average Cost for two: Selected. Outliers seen beyond 4000, need to treat them.
